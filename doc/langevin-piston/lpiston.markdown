# Langevin Piston



## Volume
F.eq.3c is $\ddot{V} = \frac{1}{W}[P(t)-P_{ext}] - \gamma\dot{V}+R(t),$
where $R(t)=\sigma\mathcal{N}=\sqrt{2\gamma k_B T/W}\mathcal{N}(0,1).$
Let $u = \dot{V}$ and
$\Delta=P(t)-P_{ext},$ F.eq.3c becomes
$$\dot{V} = u,$$
$$\dot{u} = \Delta/W - \gamma u + R(t).$$

L.chap.7.3.2 gives two schemes to integrate F.eq.3c. The first one
**Stochastic Postion Verlet (SPV)** would not be good if $\gamma$ had a big
value, since
$$u(t) = e^{-t\gamma}u(0) + \frac{(1-e^{-t\gamma})}{\gamma} \Delta/W
    + \sqrt{\frac{2\gamma k_B T}{W}\frac{1-e^{-2t\gamma}}{2\gamma}}\mathcal{N},$$
$u(t)$ would have been dominated by the random term. The other scheme BBK
(Brünger–Brooks–Karplus) is a better choice here:
$$u_{t/2}-u_0 = \frac{\Delta}{W}t/2 -\gamma u_0 t/2
    + t/2\sqrt{\frac{2\gamma k_B T}{W}\delta(t,0)}\mathcal{N}_t,$$
where $\delta(t,0)$ is approximated by $1/t.$ Similarly
$$u_t-u_{t/2} = \frac{\Delta}{W}t/2 -\gamma u_t t/2
    + 1/2\sqrt{\frac{2t\gamma k_B T}{W}}\mathcal{N}_t,$$
and
$$V_t = V_0 + t u_{t/2},$$
where $\mathcal{N}_t$ is the same random number used in two $u$-updates in step $0 \rightarrow t$.

## References
\[F\]: [Feller et al., J. Chem. Phys., 103, 4613 (1995)](https://doi.org/10.1063/1.470648).
\[L\]: [Leimkuhler et al., Molecular Dynamics, Springer (2015)](https://doi.org/10.1007/978-3-319-16375-8).

The pdf version was generated by
```bash
pandoc lpiston.markdown -o lpiston.pdf \
       -Vfontfamily=fouriernc -Vcolorlinks
```

Zhi Wang

Aug. 15, 2020.
