TPARAMS: class Ver, class ETYP

KERNEL_NAME: echarge_cu1

GLOBAL_VARIABLES:
  gvar1:
    type: real
    param_type: real
    name: ebuffer
  gvar2:
    type: real
    param_type: real
    name: f
  gvar3:
    type: real
    param_type: real
    name: aewald
  
PER_ATOM_ARRAYS:
  paar1:
    type: real
    param_type: const real* restrict
    name: chg

PAIRWISE_SCALED: |
   real r2 = image2(xr, yr, zr);
   real r = REAL_SQRT(r2);
   real invr = REAL_RECIP(r);
   real e, de;
   pair_chg_v3<do_g, ETYP, 0>(r, scale, ichg, kchg, ebuffer, f, aewald, cut, off, e, de);

PAIRWISE_CODE: |
   real r2 = image2(xr, yr, zr);
   real r = REAL_SQRT(r2);
   real invr = REAL_RECIP(r);
   real e, de;
   pair_chg_v3<do_g, ETYP, 1>(r, 1, ichg, kchg, ebuffer, f, aewald, cut, off, e, de);
